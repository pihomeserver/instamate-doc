(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{109:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return O}));var a=n(0),r=n.n(a);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=r.a.createContext({}),p=function(e){var t=r.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},b=function(e){var t=p(e.components);return r.a.createElement(l.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},u=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),b=p(n),u=a,O=b["".concat(i,".").concat(u)]||b[u]||m[u]||o;return n?r.a.createElement(O,s(s({ref:t},l),{},{components:n})):r.a.createElement(O,s({ref:t},l))}));function O(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=u;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var l=2;l<o;l++)i[l]=n[l];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},92:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return s})),n.d(t,"toc",(function(){return c})),n.d(t,"default",(function(){return p}));var a=n(3),r=n(7),o=(n(0),n(109)),i={id:"docker",title:"Docker install",sidebar_label:"Step 3 - Docker & execution"},s={unversionedId:"installation/docker",id:"installation/docker",isDocsHomePage:!1,title:"Docker install",description:"This document provides the necessary steps for installation of InstaMate on a any system that runs Docker.",source:"@site/docs/installation/docker.md",slug:"/installation/docker",permalink:"/instamate-doc/docs/installation/docker",version:"current",sidebar_label:"Step 3 - Docker & execution",sidebar:"someSidebar",previous:{title:"Environment Variables",permalink:"/instamate-doc/docs/installation/environment_variables"},next:{title:"Backup and Restore",permalink:"/instamate-doc/docs/maintenance/backup_restore"}},c=[{value:"Requirements",id:"requirements",children:[]},{value:"Instructions",id:"instructions",children:[]},{value:"Usage",id:"usage",children:[]}],l={toc:c};function p(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(a.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"This document provides the necessary steps for installation of InstaMate on a any system that runs Docker."),Object(o.b)("p",null,"This setup is recommended only if you are running InstaMate ",Object(o.b)("strong",{parentName:"p"},"on your home network"),", as otherwise your access token might be at risk. If you intend to expose InstaMate directly to the internet please secure the installation (to be documented soon)"),Object(o.b)("h2",{id:"requirements"},"Requirements"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Docker ",Object(o.b)("em",{parentName:"li"},"(if you are new to Docker, see ",Object(o.b)("a",Object(a.a)({parentName:"em"},{href:"https://dev.to/rohansawant/installing-docker-and-docker-compose-on-the-raspberry-pi-in-5-simple-steps-3mgl"}),"Installing Docker and Docker Compose"),")")),Object(o.b)("li",{parentName:"ul"},"A Machine that's always on, so InstaMate can continually fetch data"),Object(o.b)("li",{parentName:"ul"},"External internet access, to talk to the API graph")),Object(o.b)("h2",{id:"instructions"},"Instructions"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"Create a file called ",Object(o.b)("inlineCode",{parentName:"p"},"docker-compose.yml")," with the following content:"),Object(o.b)("pre",{parentName:"li"},Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-yml",metastring:'title="docker-compose.yml"',title:'"docker-compose.yml"'}),' version: "3"\n services:\n   instamate:\n     image: pihomeserver/instamate:latest\n     restart: always\n     environment:\n       - HOST=${INSTAMATE_HOST:-"0.0.0.0"}\n       - PORT=${INSTAMATE_PORT:-"8080"}\n       - SESSION_SECRET=${SESSION_SECRET:-"Your Session Secret goes here"}\n       - POSTGRES_URI=${POSTGRES_URI:-"database:5432"}\n       - FACEBOOK_APPLICATIONID=${FACEBOOK_APPLICATIONID}\n       - FACEBOOK_APPLICATIONSECRET=${FACEBOOK_APPLICATIONSECRET}\n       - FACEBOOK_API_URL=${FACEBOOK_API_URL:-"https://graph.facebook.com/v9.0"}\n       - FACEBOOK_CALLBACK_URL=${FACEBOOK_CALLBACK_URL:-"https://your_reference.ngrok.io/auth/facebook/callback"}\n       - POSTGRES_USER=${POSTGRES_USER:-instamate}\n       - POSTGRES_PASSWORD=${POSTGRES_PASSWORD:-secret}\n       - POSTGRES_DB=instamate\n     ports:\n       - "8080:8080"\n     networks:\n       - instamate\n\n   database:\n     image: postgres:13\n     restart: always\n     environment:\n       - POSTGRES_USER=${POSTGRES_USER:-instamate}\n       - POSTGRES_PASSWORD=${POSTGRES_PASSWORD:-secret}\n       - POSTGRES_DB=instamate\n     volumes:\n       - ./instamate-db:/var/lib/postgresql/data\n     ports:\n       - "5432:5432"\n     networks:\n       - instamate\n     restart: unless-stopped\n\n   grafana:\n     image: grafana/grafana:latest\n     environment:\n       - DATABASE_USER=${POSTGRES_USER:-instamate}\n       - DATABASE_PASS=${POSTGRES_PASSWORD:-secret}\n       - DATABASE_NAME=${POSTGRES_DB:-instamate}\n       - DATABASE_HOST=database\n     ports:\n       - 3000:3000\n     volumes:\n       - instamate-grafana-data:/var/lib/grafana\n     networks:\n       - instamate\n     restart: unless-stopped\n\n networks:\n   instamate:\n     driver: bridge\n\n volumes:\n     postgres:\n     instamate-grafana-data:\n')),Object(o.b)("p",{parentName:"li"},"You can also use ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/pihomeserver/instamate/blob/main/docker-compose.yml"}),"the existing file")," in the GitHub repository")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"Start the docker containers with ",Object(o.b)("inlineCode",{parentName:"p"},"docker-compose --env-file env up"),". ",Object(o.b)("inlineCode",{parentName:"p"},"env")," is the file created in the previous step (see ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/installation/environment_variables"}),"here"),") To run the containers in the background add the ",Object(o.b)("inlineCode",{parentName:"p"},"-d")," flag:"),Object(o.b)("pre",{parentName:"li"},Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"docker-compose --env-file env up -d\n")))),Object(o.b)("h2",{id:"usage"},"Usage"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Open the web interface ",Object(o.b)("a",Object(a.a)({parentName:"li"},{href:"http://localhost:8080"}),"http://your-ip-address:your-instamate-port")),Object(o.b)("li",{parentName:"ol"},"Use the menu to log in with your Facebook account, at least"),Object(o.b)("li",{parentName:"ol"},"The Grafana dashboards are available at ",Object(o.b)("a",Object(a.a)({parentName:"li"},{href:"http://localhost:3000"}),"http://your-ip-address:your-grafana-port"))))}p.isMDXComponent=!0}}]);